# Federated Learning for Health Outcomes Predictions in a Multicentric Sample of Hospitals

## ABSTRACT

We evaluated the predictive capacity of machine learning models using federated learning (FL) for COVID-19 mortality in hospitalized patients. To use the federated learning approach, we analyzed a multicentric sample of 21 Brazilian hospitals, which included 17,022 patients. A total of 22 predictors were used for the predictive models, including age, sex, heart rate, respiratory rate, pressure, temperature, and blood count data. We evaluated two scenarios based on a horizontal structure of federated learning. In the first, we evaluated the predictive performance of two models, a deep Multi Layer Perceptron (MLP) neural network and a Logistic Regression (LR), whose coefficients were aggregated by Federated Averaging. In the second scenario, we proposed and developed a federated learning approach inspired by the Random Forest algorithm. In both scenarios, the federated learning models were compared to the predictive performance of local training data from each hospital, using the same hyperparameter space. On average, the AUC-ROC of the first scenario was 0.8117 for LR, with an average gain of 7.21% by using FL, and 0.7962 for MLP, with an average gain of 12.79% by using FL. The decision tree-based model in the federated context obtained an AUC-ROC of 0.8022, with an average gain of 6.48% by using FL. Gains in predictive performance of the FL models were observed for most hospitals compared to training with only local data. A larger predictive gain for federated learning was observed in hospitals with a smaller amount of patient data.

## CONCLUSION

The use of federated learning methodology presented significant gains compared to local learning in all models tested in both learning contexts explored here. Despite the heterogeneous distribution of data across Brazilian regions, federated learning was able to learn and contribute to the predictive gain of COVID mortality in virtually all ranges of available data for the training process. In this regard, as shown in Figure 3, the greatest gains when incorporating federated learning occurred in hospitals with a smaller number of patients, which consequently have fewer pieces of information to predict mortality. It should be noted that the decision tree-based federated learning model proposed by us achieved an average AUC-ROC of 0.8022 with lower variability in this metric among the evaluated hospitals (Coefficient of Variation: 7.30%). The LR model achieved an average AUC-ROC of 0.8117, representing the highest metric in the federated context. Therefore, federated learning proved to be a relevant tool to increase the predictive capacity of COVID-19 mortality for hospitalized patients, in a context of privacy and heterogeneity of hospital data.
